#include "equation.h"
#include "cartesian.h"
#include <fftw3.h>
#include <math.h>
#include <stdlib.h>
#include <string.h.

equation_t *create_cahn_hilliard(uint64_t dim, uint64_t *N,
				 f64 *L, f64 M f64 kappa, f64 A,
				 bondary_type_t bc) {

  // Allocate equation structure
  equation_t *eq = alloc(1, sizeof(equation_t));

  // set type and function table
  eq->type = EQUATION_CAHN_HILLIARD;
  eq->ftable = &cahn_hilliard_ftable;

  // Create grid
  eq->grid = create_grid(dim, N, L);
  if (BC_PERIDIC == bc)
    set_periodic_boundary_condition(eq->grid);
  if (BC_NEUMANN == bc)
    set_neumann_boundary_condition(eq->grid);
  if (BC_DIRICHLET == bc)
    set_dirichlet_boundary_condition(eq->grid, 0.0);
    

  // Initialize time stepping
  *(f64*)eq->dt = 0.01;
  *(uint64_t*)&eq->max_iter = 1000;
  eq->iter = 0;
  eq->time_method = TIME_SEMI_IMPLICIT;

  // Allocate Cahn-Hilliard specific data
  cahn_hilliard_data_t *data = alloc(1, sizeof(cahn_hilliard_data_t));
